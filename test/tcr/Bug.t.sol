// SPDX-License-Identifier: MIT
pragma solidity ^0.8.28;

import { FlowTCRTest } from "./FlowTCR.t.sol";

import { IERC20 } from "@openzeppelin/contracts/token/ERC20/IERC20.sol";
import { Strings } from "@openzeppelin/contracts/utils/Strings.sol";
import { NounsFlow } from "../../src/NounsFlow.sol";
import { Flow } from "../../src/Flow.sol";
import { IFlow, INounsFlow } from "../../src/interfaces/IFlow.sol";
import { Strings } from "@openzeppelin/contracts/utils/Strings.sol";
import { ERC1967Proxy } from "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import { NounsFlow } from "../../src/NounsFlow.sol";
import { IStateProof } from "../../src/interfaces/IStateProof.sol";

contract TCRFundFlowTest is FlowTCRTest {
    // add 4 items, vote and execute using requester

    function test_issue() public {
        vm.createSelectFork("https://mainnet.base.org", 21347817);

        address deployedFlow = address(0x816897059Ce5938C16A2770Bf9BA9A7caA487639);

        address nounsFlowImpl = address(new NounsFlow());
        // upgrade flow to current implementation
        vm.prank(0x289715fFBB2f4b482e2917D2f183FeAb564ec84F);
        Flow(deployedFlow).upgradeTo(nounsFlowImpl);

        // set flow rate to 1000000
        vm.prank(0x289715fFBB2f4b482e2917D2f183FeAb564ec84F);
        IFlow(deployedFlow).setFlowRate(3858024691358);

        vm.prank(0x289715fFBB2f4b482e2917D2f183FeAb564ec84F);
        IFlow(deployedFlow).setFlowRate(3858024691358 / 2);

        vm.prank(0x289715fFBB2f4b482e2917D2f183FeAb564ec84F);
        Flow(deployedFlow).setManagerRewardFlowRatePercent(200000);
    }

    function test_bug() public {
        vm.createSelectFork("https://mainnet.base.org", 21389970);

        address deployedFlow = address(0xe8A8b17A49403Ac0744f018EbCcc15D1497fB9bC);

        bytes32[] memory stateRootProof = new bytes32[](12);

        stateRootProof[0] = bytes32(0xf723c691f2fc28cc91d2c0aa882a97c894f1489fcf6a46f39a87695a9651acfa);
        stateRootProof[1] = bytes32(0x5ba5eb30c3fe4def6a13f82b5fce63bc9f9e57b19c7447710761147cd3abb18f);
        stateRootProof[2] = bytes32(0xd316f75ba03a247df55bcbb170cbb91ba1962678d1cc203e7f10b9d34272c938);
        stateRootProof[3] = bytes32(0x08fb62e4efb6ce921d4ed2f35ef3ba6a4bb2d879bbf283c2c827c31b59d43d94);
        stateRootProof[4] = bytes32(0x536d98837f2dd165a55d5eeae91485954472d56f246df256bf3cae19352a123c);
        stateRootProof[5] = bytes32(0x5f37836c285332f60c7e838a98686f6c5a42df7af9c608d94d1148cc4eba7440);
        stateRootProof[6] = bytes32(0xb46f0c01805fe212e15907981b757e6c496b0cb06664224655613dcec82505bb);
        stateRootProof[7] = bytes32(0xdb56114e00fdd4c1f85c892bf35ac9a89289aaecb1ebd0a96cde606a748b5d71);
        stateRootProof[8] = bytes32(0x9979110132a7d19133043d74bf97ca7f080f03a03ab3fec0307bf3384d1749d5);
        stateRootProof[9] = bytes32(0x0000000000000000000000000000000000000000000000000000000000000000);
        stateRootProof[10] = bytes32(0xf5a5fd42d16a20302798ef6ed309979b43003d2320d9f0e8ea9831a92759fb4b);
        stateRootProof[11] = bytes32(0x6e3932d3cb4276c4ecd71e65a26a90b6f38081648aefd837c3ab674a0db6a793);

        bytes[] memory accountProof = new bytes[](9);

        accountProof[0] = bytes(
            "0xf90211a035bbc086d6e5ebe842934d4deedccc145828a2b5b8d92f0a6e15755b2c6cdd7ba0f18cda3d1f9b1ff60883d2344f97db4f5d9a2c4453cf3f9de50dcdf10d453a7da0e5cf30bed153e236df352cbc02d709e41a642e13440895b1974c733f177c286aa0cdfaab3e2b82d925c480831f8697d12610b8a3feec0b24e17d39cf8f788ea6efa02524fae4f4cf45b640f1436c7e9d6aab9848513ad7ac9a4d412490870a234f9fa011f1cf59796d662e56c8110ef50d7c4f3bf7cdee46486486647f12068ba2df15a0aa6c565681a458e1937026ac24f0ef754b999cee2d12755f00b1fd90698576bfa0394c6e2bc52fa2a321b24bcfec2a6d03d1ab85cab26628fd1e40bf83155e0e97a08cae4dc36d709f52fc3a7adbb3065e675cef0c551aca402ef37dac7446d4ca46a0db803d6f4b88b9b1f301e745ff032e9e2c5ac83de15d8fd54341241e1e4522f1a0ebbfcdb98f21a6c4496147104096589645c3dff440f4bf13a54965a150f2c4bca0ebb92dd3ec406bea7db73b95bf3cb86bfe262ca405d1441081f41c04ad1e5d9ba0fa192b122acfa9d426309749aea1cfd41472bcac1f575551852318a9f492ccaaa03eca8fc8c0cd82023dbce9eee4a3122e7e2049bcd1c86c18d2c3228872770372a0a937f19691799a4b827c3dc645ef0d83783ad91af7f03981c29d6978d9cda23ba00fa5dda33ebbb6f24b987b714f38e70270547af4db0f5c796a0d450e506ce0dd80"
        );

        accountProof[1] = bytes(
            "0xf90211a0d82aa080560b986bb74cdb1ff6d3ddfad9befdc958818b7cb8dd584d8b7e746da0c6116cc2bc5794abf18e70f6f60747d8ebbeb0360859962470d558cc1225c5b0a047994210a22b09cba862ffe2f65d824e41f4b52f7b32b29e3f886c3251376b0da004b96c8875f73210ee0e45652492203c4b77d456ef9730ad9faf59608a778ff6a0cad66bc1865f3a606f8dad16e7decf600a5181717fc9528dbffd355e3350fd92a0117563a039e2fd27a559d0bd0de3d349dd52af570dd41d0886b38c8a1099d0d4a0520331f07f775d0bb168bd866ea978d141086647e04d2254830cb5ad798bc159a0bdec3822c2e5c195f3261abf3dfc68442ed4ccf7466b16899f83a65a4ea01cdaa062dcfb5e4144a088c0f4131f09bc262cbd5bec8030d68ccf43160ce98efd79f3a08f7c188d2beb08a74946de4127386e5c64434e67930516b7c1de263c3d54a79ba0a3441ce8afa17b4bfcc43ca92f2d40e81713717e84a3eca4e207c76d60ee5e48a03a60f95b968a689b8bb8e027625a4f54c603f746dde571bb2bd1159b255f01c5a0253c249bc070cd6956161128d07066eeef86888039c66f5ad6b4e6878bf8999da0cc2eef67aee8152a41dcc1c0f3252e8a9146943aa53f3c5e8334ec29a6ac72f1a0bd573eb1e3101b1b32d109e4f4ba24d262a881244991f0d2fe137f4e6e065911a0b7374265ecc7bf346dd843a4b5c558a1662b36ae5d7029d621c9e0fc1cfaf10480"
        );
        accountProof[2] = bytes(
            "0xf90211a0284f795866e72db7b06328c51b38f4cc6199b8b9f94ebac7c1fcad6cfe87124ba04ccf72d5e043238b63505c37f6ac2fd3568b48253188766516637042d64f81f1a091862ecce98df184eac1a72af7213c5f71e5874534939a0138a2a22813be0480a0f7eb70caf09cdb8317c1add0fade12cda7c2a229fb8bacdbf80a66ca5aa8b210a09bc26e569ed7492dfb5f58a4fadccca0fe152c7be11d8c49ff3ebaf6f52f6b67a024927caf6725be1f87719d0b36cd64ffdc70627b7ec9bf466a70ce063fc990a0a025574ec971117c4aeb3ceff89c9cfc1490cbfaa1add917cd77e489291f414f83a0528aec8f2106c73a9211385a6adb542160d82c6297e66f6e5586877ad086afcea039cbf12852c7f9998330a92de57dae993c4d496ea07e75f8ca090c2039c9fbc3a034bb54ddeb8b1286286673be21e7154161e92390dee3da59001713e6b18e0b6ba0023664351f399017f3dbf0fcdc1acaffd3b0d9119767352a5e838658fad2076ea0acd6024153370e88909159a21383f542ce433974f7d400c30cce786f365c4adba078197c410dc1e963f70ae751546fd4548f1a5f2295c27f440cac90a25eb9c43ba03d9dbdb85ef6969de492b5f095e4fbf1d5e788b85900047bb83f6d57aedb2a17a08041e32f398f926d1a7a7182fb406d3c1adfd4cd0fd55815851b619a1a640356a04afca5f9a6c8d8ca45c0ca745de36abc6305e30f7e2875724e0a6e4a9a9ab55780"
        );
        accountProof[3] = bytes(
            "0xf90211a0fe99f1eb176d90456c901068775584ef562cea6ff2b39119522d99962840c380a04cb21c4a9d6886f92de4e6ae8dac2592ce29c61cb7a3b43c087c06e598d3acc3a0c95da747b84d08596763d441e221cae6133be6b96835ebe0cfc3bc4ab53dba42a05f07dc72627d78faf7e48d6c7d2e9ae66a8d2ff8d0323bb34e00174d1c343269a0a882655ea74affd60515364503e64a148faa2ca1eca4904fea5c223f2103a0a0a0f4bfe14e23c3d7749639976fc760f07115beeefa792b8d66379434f27e84cb38a094db84af3b491640f7bd83b54e7a12df6a259ad52d79cd0aae10d71fc6eba8b0a00ff2fcf8f3735452e2f63652a1de8a25073b7144208cab157c2ae31bf4af2bb1a004f6ae330864eabf5b75735751b61af80ae705759d48c4a871b2357cafefc59fa03aa889d0d387913e79b2d62d7d6ee20b09737ec6e5fe765b1fb8d8480ff49748a04a9407ca091ff88e30f47540257633dacefff591e2cdac47e5bb6ab5ba2e2e6ca0dbad4a32c102df6e98a21b695a8ff1a30f0b2ed6eef6b3cf725268ca928898e8a0221cea19ca41dd515306928ce658a4afbff20c42b5c7e303077e4fd7702049b3a0d65e834f0e190a05afb7cbde2c5bd8b529bc88985108e4e838743c852ff9bf5aa070457ed1a4574a97f8efc1d88ce37bff70459b52b0a1cbeadfc90104abbcb923a027ae516f1a33977a81052144fd1c877427dd678246297446f450abb41480159c80"
        );
        accountProof[4] = bytes(
            "0xf90211a0f445f0acff3de936307c3da2e69afa28a7fd34d96b92e5daa5d798fc00cb98e1a0d447becbd8d8112ac4d3fb782b780015c87c90b31b504842be9e05d04c22b003a06ea90bf52ad2601cff12ad1db23f07691a919c73c3aac839345fb70dd1d02a91a074ff51808e15da6983c53285c11bcda739ae79d55879121b43521a3afc1fa814a0c8e3e937e8e5c278079f1c60eb5634565ff1e3cf6f13b129577cb44947d81e12a09f5d5f16347727dffd6ef02a289863cf64ea27f2a479b3a645a2367c69ab5a25a0228505620aab1bfd61b49dc92f2d2a4915cdf36b19c0eaca3b39789e73817074a0edb4a1dc88951ec51e25dee34874ee10f426e25ce4d4064fa13e70318fd0f97da0d2f0357ed2fbdf283c877f16f9dad5fda2f7694b67810dfe433021f4caa0b8d2a0c49b22084620994b9f8236be2f3c77f06853d63db9291536ca4287f836fa1b3ca0cb3dfa6218a9814eed033cb005a3de46f2ef71b8ac3dfd12ba316d0394b13677a0f92f2a1c73cd5bb0960e888ecaba6a7cdfd6965184b8a8a84e560d13bcb640dda01970f64a8e9234c94b11524edcc3a7f644bd3244b3180dd469879de39a31a433a07cf77d1edfe728652b0e93800a1bb33fee312e20a0e6ffa728c612878fc5f689a0e1925c023c244290f36ea93aba998c57da4eda24683c4ad8d42ae32f3b90c915a073c79e373f0456ce9305ed64b0ac90827058b5f54c58d2516844605a088862b980"
        );
        accountProof[5] = bytes(
            "0xf90211a0203fe040795adb672eddb5f8bf95b22ea3c302b0ac3367fdba95d2f8b0d80c2da01b63370ae9aab5ed2b501b0d917853ec4930ae8429b9cb99044105be5615c32da0b09c98587e903088e3a20d052e818e4164f78a97958caf8bcc84105145a5bf6aa0a2f94fd34b4b002938e0f6d178492d4ef43f1263c231bae903b1bf7d00b024c8a074d803be07f36aaa629a98dcfc830c13921a7404a135eb7a6f73ca3bfc9804fea075b4ca749efece885784606f048ace494dfbd82afec705e6df489a5c2dd2b746a041adc18adeb4614d3ae04208ad7752d0fd3847d9a2006f619712df5e3c83c6dfa0d2b36ff8c97d28f09100915ff4fe2aa0790e4846d79a45d21d3df791d6c81cfea0d3f644617d23c234c35995b2ae1ddcf3bdd3dfe130cc34d2929fe0baac8dd719a0bcdc122ee6e6b27dcb32edbe51ce2fcf0de691567bb8f4d0f4be7cc5d1e237b5a0a3abad6f52ecdfddcf6ff4853193e1dc569c588b34428d4030695e8d3aaa7c72a02d905a4c0f87f2b394bc07ea522d682c44b30522da75ab58ebc9476d768b2ed1a03930408f27bbd365824c07ae48ad93680cade9d5f118022cfe6c32b2a3a65b79a0e67180fb6bca2a28766cc2de12efe941d979c88eb31a9686f8b0b96bc4a1c8baa08228b191580034d140251afa52d1cc90a9d92bda98e285b051de27218ed26335a00b0e57e8c14a7425fe293eac6cc5bf2a4f86204973c91486e138804e9259ae7380"
        );
        accountProof[6] = bytes(
            "0xf90171a0c308789f6653bbb4d124c88f013dda9995c1d6dbcdf9b03cb5776989fda19e76a013c7e91e5d8511b075d09145b74e1fd4bcafa324c7ed77d17d76427f9361b4ff80a06e6d88bd233bdad5929fb9ab6527a64c41476fe07a10e34e6356aeabe0f29a2ea02fd2563cf8645683806f4403c23ec24e631abd9ad28489fc06470dd2df219397808080a0b4936eceb3cac64eaa4edde1e0da506c9ec2ebfc1155755ae84fb138def7505b80a073cfab0c1cedfacefe365235dd7f23313d6a988572c0876515077dc3c8e71572a0b9c224000732e7866fe965d084816c1db44a47ae9254173c66b7d1ebb5c0d380a0965ecec8b4d42c476b3aa9eee24fc67b2040492afec2d63016ea09b3abcb1a2aa0aaf50cd29354dae1169db107f5f32e7f2a023ce3f8d559a67be0d01b0f82c6f9a02a959196d3bdfbe36a86c90bdd35321037750f9f9e5e105f799bf70036f64965a08e9abd848fe9829aeb0d4734edb2385af9673450e6b8fea17344d3a3f5217e2c80"
        );
        accountProof[7] = bytes(
            "0xf85180a0a27f91f6cbf28c8291a30ad43b16c9dd3bf0b4408918e5f1f60560e2ab682bf280808080808080808080a0b6f0084a2832cf17c35cd2ff41a8de934531e376e525b996889655a714af0b9e80808080"
        );
        accountProof[8] = bytes(
            "0xf8669d20d2a317b152655f2ac82a4d056037698c7fb685f1e42121910bd796cbb846f8440180a0170ec337b0150e44ed89d73f0bd6a97a0a0ee6fcf81f68a73bf32f009292cc9ba054aa5f94e823cdab6f18fd7f7d5038a4920ed03bcbd3d59d7a5ab3f19a1a8acd"
        );

        address[] memory owners = new address[](1);
        owners[0] = 0x289715fFBB2f4b482e2917D2f183FeAb564ec84F;

        // Call cast votes on the Flow contract
        uint256[][] memory tokenIds = new uint256[][](1);
        tokenIds[0] = new uint256[](2);
        tokenIds[0][0] = 0;
        tokenIds[0][1] = 2;

        uint32[] memory amounts = new uint32[](8);
        amounts[0] = 50000;
        amounts[1] = 50000;
        amounts[2] = 50000;
        amounts[3] = 50000;
        amounts[4] = 50000;
        amounts[5] = 700000;
        amounts[6] = 30000;
        amounts[7] = 20000;

        bytes32[] memory voteHashes = new bytes32[](8);
        voteHashes[0] = bytes32(0x46910e299c6b242234cb887bfc2e270e349e5c3d12c666fad4cbc9db740cd62a);
        voteHashes[1] = bytes32(0x1e056b9360b9769355c524af1d89470f412999e04fea4f42d12babb5d76f8d2e);
        voteHashes[2] = bytes32(0x2fe58b29d6194b87cf8a57cfcdf92e0ed363fe64c8abf0075a7b9e26ce3bd29e);
        voteHashes[3] = bytes32(0x5f10ecd51d84f6e13811204060311db786aa952769226f4ffa99fff068bed623);
        voteHashes[4] = bytes32(0x6cf445aa80f59f4bb641b3bbb54c1d1fe7a2460a9e1e4a9d79cdfae6576dc906);
        voteHashes[5] = bytes32(0x3f50c2a9210548223168f860b6aef6b488444fe303de3eced59f9d92a329a487);
        voteHashes[6] = bytes32(0x1256fda15c84c6bcc243e34e743b7d07cd14eae43a846cfde70ac1c83cb9c3a4);
        voteHashes[7] = bytes32(0x4da14d5fc72e395af19017a834e7875d5eb40abdea31e78bc3a3e95db37c493e);

        bytes[][][] memory ownershipStorageProofs = new bytes[][][](1);
        ownershipStorageProofs[0] = new bytes[][](2);
        ownershipStorageProofs[0][0] = new bytes[](3);
        ownershipStorageProofs[0][0][0] = bytes(
            "0xf90211a0c69079c805996a72e60bf2a8d857ba48968c9a1c209f32ff5dd749c5d43384b0a00261d8b6026b74387fdbdd0a649e5a83555a5145621a6c76253570870c609088a0050b8df7c56e73c6e0443fcec922d30fde1a03b163c2fab13ad08efdc4fc3443a0576ffda985a701e7505feb8b443914464f9dcbee1b73e4cbc079305a0cbb4a81a0a631cc1c8aaba05078e89b051dce0c5daf860d9533e6bde13e71308ca50377b5a01ebef2be6d49cdb82aeb3d9596128f884dafd39ed3c32050feb84a3ddb235e94a0d5c3d453d8b0ce9456746d61e2598074f1e8e2700436517e9330fa3f4d8e445ea0ebec3ec4dc53b0de4bc6d6ed8579055c264e50502ed220f033e161607b52a0a2a040386315634e7e45544014aff19cb0261f4110915f8fc559899803737b1ac3e1a0e849031c1ddd42f50cd47c2aba76749ca0982d00ab5d089edaea4822c40ba98aa0c4b76124dc1daa152d9122dc58ac7430292eea2c1bc0aaa64d3295d1b9ec30eaa07e51b7986593fc1c1e80932f9be658eccecf67adcfbe74ad51bda171f0b73f60a0726462065a8ae6a750678fd3cce59378d215037bb2fc64d8191a17d2135851a9a06ec21adf966effdc4a5ba75102dd14127fa52df102c227fbec5918e6d7f49461a03ae59ed7699f4f1f49d57b1e55e9d7a1330fac55ec1ea9cd49f720c4b23c702ca0858607b825e19d4404616654cd9a36b646b14d2461a44d12964688eb3ace9f1f80"
        );
        ownershipStorageProofs[0][0][1] = bytes(
            "0xf8f1a099a31f2b8666bab31e7a26aa070df7a31f11839f59543bd8298bde23d049cf7d8080a04f37be8fd9ae95849c32e907ec60b98bfbd4dc0ef906bd50adaf534fac19575ba058213fdb37acbb6a4a2a77969c1204b2443dfaa6b950b7f2d80d2d125e57b24b808080808080a031484c553be1c04160431714136d91c07b0c7cb4953947dc0c65f5ad2ed9ae08a0932c975183263cfa64d378c399b494450ff0e948ef1b7528a45be5e60bf31c7c80a04d97598c02fc80d0460c9735cf016d93a47ec24b334493ffb05e9424bafaad6da07713c86a60f429d752ddb6973fbd90dadd4150b844523993d9e337bc61cf72e380"
        );
        ownershipStorageProofs[0][0][2] = bytes(
            "0xf7a020b339bd1c51c488f6134f4ac63d1594afad827b3401c3fc51ed1da74a8ca14e9594289715ffbb2f4b482e2917d2f183feab564ec84f"
        );

        ownershipStorageProofs[0][1] = new bytes[](3);
        ownershipStorageProofs[0][1][0] = bytes(
            "0xf90211a0c69079c805996a72e60bf2a8d857ba48968c9a1c209f32ff5dd749c5d43384b0a00261d8b6026b74387fdbdd0a649e5a83555a5145621a6c76253570870c609088a0050b8df7c56e73c6e0443fcec922d30fde1a03b163c2fab13ad08efdc4fc3443a0576ffda985a701e7505feb8b443914464f9dcbee1b73e4cbc079305a0cbb4a81a0a631cc1c8aaba05078e89b051dce0c5daf860d9533e6bde13e71308ca50377b5a01ebef2be6d49cdb82aeb3d9596128f884dafd39ed3c32050feb84a3ddb235e94a0d5c3d453d8b0ce9456746d61e2598074f1e8e2700436517e9330fa3f4d8e445ea0ebec3ec4dc53b0de4bc6d6ed8579055c264e50502ed220f033e161607b52a0a2a040386315634e7e45544014aff19cb0261f4110915f8fc559899803737b1ac3e1a0e849031c1ddd42f50cd47c2aba76749ca0982d00ab5d089edaea4822c40ba98aa0c4b76124dc1daa152d9122dc58ac7430292eea2c1bc0aaa64d3295d1b9ec30eaa07e51b7986593fc1c1e80932f9be658eccecf67adcfbe74ad51bda171f0b73f60a0726462065a8ae6a750678fd3cce59378d215037bb2fc64d8191a17d2135851a9a06ec21adf966effdc4a5ba75102dd14127fa52df102c227fbec5918e6d7f49461a03ae59ed7699f4f1f49d57b1e55e9d7a1330fac55ec1ea9cd49f720c4b23c702ca0858607b825e19d4404616654cd9a36b646b14d2461a44d12964688eb3ace9f1f80"
        );
        ownershipStorageProofs[0][1][1] = bytes(
            "0xf8d180a0883eb95af0f67bd54e412a3ee697e20b8f3e02a2d00235e2d2bfd30b1f49b24ba0c053828d28663134543fd497db9addb6d2ae29aac91298dcab3b442952b8b36a808080808080a09d4dc6bb1802a45d4cdb09cba11aa688de3c83722f602c42cb68bb539e591e6d80a0d0d731859d3e57afd0f2b0011020aa183484e80aa2fc393612e5f3db27f17949a077295af388775d543e2874903ea9914c6423aed27f13146a9d5239c46db3e541a0d2d76a91ed39d54589fb9db7e0d97ebfba534cc122fe656dcba7d1ba4b202997808080"
        );
        ownershipStorageProofs[0][1][2] = bytes(
            "0xf7a020b5847ec9d8983e32da86b2c2bedc7b0bcabd1d214557fda78706fe7ba568ce9594289715ffbb2f4b482e2917d2f183feab564ec84f"
        );

        bytes[][] memory delegateStorageProofs = new bytes[][](1);
        delegateStorageProofs[0] = new bytes[](3);
        delegateStorageProofs[0][0] = bytes(
            "0xf90211a0c69079c805996a72e60bf2a8d857ba48968c9a1c209f32ff5dd749c5d43384b0a00261d8b6026b74387fdbdd0a649e5a83555a5145621a6c76253570870c609088a0050b8df7c56e73c6e0443fcec922d30fde1a03b163c2fab13ad08efdc4fc3443a0576ffda985a701e7505feb8b443914464f9dcbee1b73e4cbc079305a0cbb4a81a0a631cc1c8aaba05078e89b051dce0c5daf860d9533e6bde13e71308ca50377b5a01ebef2be6d49cdb82aeb3d9596128f884dafd39ed3c32050feb84a3ddb235e94a0d5c3d453d8b0ce9456746d61e2598074f1e8e2700436517e9330fa3f4d8e445ea0ebec3ec4dc53b0de4bc6d6ed8579055c264e50502ed220f033e161607b52a0a2a040386315634e7e45544014aff19cb0261f4110915f8fc559899803737b1ac3e1a0e849031c1ddd42f50cd47c2aba76749ca0982d00ab5d089edaea4822c40ba98aa0c4b76124dc1daa152d9122dc58ac7430292eea2c1bc0aaa64d3295d1b9ec30eaa07e51b7986593fc1c1e80932f9be658eccecf67adcfbe74ad51bda171f0b73f60a0726462065a8ae6a750678fd3cce59378d215037bb2fc64d8191a17d2135851a9a06ec21adf966effdc4a5ba75102dd14127fa52df102c227fbec5918e6d7f49461a03ae59ed7699f4f1f49d57b1e55e9d7a1330fac55ec1ea9cd49f720c4b23c702ca0858607b825e19d4404616654cd9a36b646b14d2461a44d12964688eb3ace9f1f80"
        );
        delegateStorageProofs[0][1] = bytes(
            "0xf89180a07e49b8c266b9b220c46842355f0554cb3a27735839564e3f6a40a628182850fc8080808080a0eedcb940b34883ede10d8b3bd348ec9e216a03f587ad4b406bc2ba3afd92e07fa08e493f75de669b7f76b0d8f2a64de0d4f87f199f850c1f62eb3b3fcdaf6d279f8080808080a0022bcb81a88179680e9c3dc5a336d1274e0cf88aef471dd4df279261dc318d2c8080"
        );
        delegateStorageProofs[0][2] = bytes(
            "0xf7a020951d07fefd914d4f566409882513a84da64427694c6d0a570e890a56337f6c9594289715ffbb2f4b482e2917d2f183feab564ec84f"
        );

        vm.prank(0x289715fFBB2f4b482e2917D2f183FeAb564ec84F);
        INounsFlow(deployedFlow).castVotes(
            owners,
            tokenIds,
            voteHashes,
            amounts,
            IStateProof.BaseParameters({
                beaconRoot: bytes32(0x24d0edf9f4f830042b047e9c1ead45c80ea19d3dc232cecabc1759755b6e3d2b),
                beaconOracleTimestamp: 1729569257,
                executionStateRoot: bytes32(0x7ad2af07a780a521469c775cb8b371c9249e5bad6ea6a08d07135737526757a4),
                stateRootProof: stateRootProof,
                accountProof: accountProof
            }),
            ownershipStorageProofs,
            delegateStorageProofs
        );
    }
}
